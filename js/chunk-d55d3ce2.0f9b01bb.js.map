{"version":3,"sources":["webpack:///./src/views/UsersTop.vue","webpack:///./src/views/UsersTop.vue?5e7a","webpack:///./node_modules/core-js/modules/es.array.map.js"],"names":["class","isLoading","users","user","key","id","to","src","emptyImage","image","name","followerCount","isFollowed","type","unfollow","follow","mixins","components","NavTabs","Spinner","data","created","this","fetchUsers","methods","getTopUsers","map","FollowerCount","fire","icon","title","console","log","userId","addFollowing","status","Error","message","deleteFollowing","__exports__","render","$","$map","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT","target","proto","forced","callbackfn","arguments","length","undefined"],"mappings":"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","file":"js/chunk-d55d3ce2.0f9b01bb.js","sourcesContent":["<template>\r\n  <div class=\"container py-5\">\r\n    <NavTabs />\r\n    <Spinner v-if=\"isLoading\" />\r\n    <template v-else>      \r\n      <h1 class=\"mt-5\">\r\n        美食達人\r\n      </h1>\r\n      <hr>\r\n      <div class=\"row text-center\">\r\n        <div \r\n          v-for=\"user in users\"\r\n          :key=\"user.id\"\r\n          class=\"col-3\"\r\n        >\r\n          <router-link \r\n            :to=\"{ name: 'user' , params: { id: user.id }}\"\r\n          >\r\n            <img\r\n              :src=\"emptyImage(user.image)\"\r\n            >\r\n          </router-link>\r\n          <h2>{{user.name}}</h2>\r\n          <span class=\"badge badge-secondary\">追蹤人數：{{user.followerCount}}</span>\r\n          <p class=\"mt-3\">\r\n            <button\r\n              v-if=\"user.isFollowed\"\r\n              type=\"button\"\r\n              class=\"btn btn-danger\"\r\n              @click.stop.prevent=\"unfollow(user.id)\"\r\n            >\r\n              取消追蹤\r\n            </button>\r\n            <button\r\n              v-else\r\n              type=\"button\"\r\n              class=\"btn btn-primary\"\r\n              @click.stop.prevent=\"follow(user.id)\"\r\n            >\r\n              追蹤\r\n            </button>\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport NavTabs from './../components/NavTabs.vue'\r\nimport Spinner from './../components/Spinner.vue'\r\nimport userAPI from './../apis/user'\r\nimport { Toast } from './../utils/helpers'\r\nimport {emptyImageFilter} from './../utils/mixins'\r\n\r\nexport default {\r\n  name: 'UserTop',\r\n  mixins:[emptyImageFilter],\r\n  components:{\r\n    NavTabs,\r\n    Spinner\r\n  },\r\n  data() {\r\n    return {\r\n      users: [],\r\n      isLoading:true\r\n    }\r\n  },\r\n  created() {\r\n    this.fetchUsers()\r\n  },\r\n  methods: {\r\n    async fetchUsers() {\r\n      this.isLoading = true\r\n      try{\r\n        const { data } = await userAPI.getTopUsers()\r\n        this.users = data.users.map(user => ({\r\n          id: user.id,\r\n          name: user.name,\r\n          image: user.image,\r\n          followerCount: user.FollowerCount,\r\n          isFollowed: user.isFollowed\r\n        }))\r\n        this.isLoading = false\r\n      }catch(error){\r\n        this.isLoading = false\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法取得美食達人資料，請稍後再試'\r\n        })\r\n        console.log('error', error)\r\n      }\r\n      \r\n    },\r\n    async follow(userId){\r\n      try{\r\n        const { data } = await userAPI.addFollowing(userId)\r\n        if(data.status !== 'success') throw new Error(data.message)\r\n        this.users = this.users.map( user => {\r\n          if(user.id === userId) {\r\n            return { \r\n              ...user,\r\n              followerCount: user.followerCount + 1, \r\n              isFollowed: true\r\n              }\r\n          }else{\r\n            return user\r\n          }\r\n        })\r\n      }catch{\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法加入追蹤，請稍後再試'\r\n        })\r\n      }\r\n      \r\n    },\r\n    async unfollow(userId){\r\n      try{\r\n        const { data } = await userAPI.deleteFollowing(userId)\r\n        if(data.status !== 'success') throw new Error(data.message)\r\n        this.users = this.users.map( user => {\r\n          if(user.id === userId) {\r\n            return { \r\n              ...user, \r\n              followerCount: user.followerCount - 1,\r\n              isFollowed: false\r\n              }\r\n          }else{\r\n            return user\r\n          }\r\n        })\r\n      }catch(error){\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法取消追蹤，請稍後再試'\r\n        })\r\n      }    \r\n    }\r\n  }\r\n}\r\n</script>","import { render } from \"./UsersTop.vue?vue&type=template&id=6ff0970a\"\nimport script from \"./UsersTop.vue?vue&type=script&lang=js\"\nexport * from \"./UsersTop.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\user\\\\JackHuo\\\\WebDevelopment\\\\Project\\\\Vue\\\\forum-front-end-vue\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n"],"sourceRoot":""}