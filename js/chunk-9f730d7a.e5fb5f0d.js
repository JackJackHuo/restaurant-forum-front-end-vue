(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9f730d7a"],{"0995":function(e,t,n){"use strict";n("3f71")},"3f71":function(e,t,n){},5652:function(e,t,n){"use strict";n.r(t);n("b0c0");var r=n("7a23"),a=function(e){return Object(r["v"])("data-v-aadf0b18"),e=e(),Object(r["t"])(),e},c={class:"container py-5"},i={class:"my-4"},s={class:"form-row"},o={class:"col-auto"},u={class:"col-auto"},d={key:1,class:"table"},b=a((function(){return Object(r["g"])("thead",{class:"thead-dark"},[Object(r["g"])("tr",null,[Object(r["g"])("th",{scope:"col",width:"60"},"#"),Object(r["g"])("th",{scope:"col"},"Category Name"),Object(r["g"])("th",{scope:"col",width:"210"},"Action")])],-1)})),g={scope:"row"},l={class:"position-relative"},f=["onUpdate:modelValue"],m=["onClick"],p={class:"d-flex justify-content-between"},j=["onClick"],O=["onClick"],h=["onClick"];function v(e,t,n,a,v,w){var k=Object(r["z"])("AdminNav"),C=Object(r["z"])("Spinner");return Object(r["s"])(),Object(r["f"])("div",c,[Object(r["i"])(k),Object(r["g"])("form",i,[Object(r["g"])("div",s,[Object(r["g"])("div",o,[Object(r["I"])(Object(r["g"])("input",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return v.newCategoryName=e}),type:"text",class:"form-control",placeholder:"新增餐廳類別..."},null,512),[[r["E"],v.newCategoryName]])]),Object(r["g"])("div",u,[Object(r["g"])("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=Object(r["J"])((function(e){return w.createCategory()}),["stop","prevent"]))}," 新增 ")])])]),v.isLoading?(Object(r["s"])(),Object(r["d"])(C,{key:0})):(Object(r["s"])(),Object(r["f"])("table",d,[b,Object(r["g"])("tbody",null,[(Object(r["s"])(!0),Object(r["f"])(r["a"],null,Object(r["y"])(v.categories,(function(e){return Object(r["s"])(),Object(r["f"])("tr",{key:e.id},[Object(r["g"])("th",g,Object(r["B"])(e.id),1),Object(r["g"])("td",l,[Object(r["I"])(Object(r["g"])("div",{class:"category-name"},Object(r["B"])(e.name),513),[[r["F"],!e.isEditing]]),Object(r["I"])(Object(r["g"])("input",{"onUpdate:modelValue":function(t){return e.name=t},class:"form-control",type:"text"},null,8,f),[[r["F"],e.isEditing],[r["E"],e.name]]),Object(r["I"])(Object(r["g"])("span",{class:"cancel",onClick:Object(r["J"])((function(t){return w.handleCancel(e.id)}),["stop","prevent"])}," ✕ ",8,m),[[r["F"],e.isEditing]])]),Object(r["g"])("td",p,[Object(r["I"])(Object(r["g"])("button",{type:"button",class:"btn btn-link mr-2",onClick:Object(r["J"])((function(t){return w.toggleIsEditing(e.id)}),["stop","prevent"])}," Edit ",8,j),[[r["F"],!e.isEditing]]),Object(r["I"])(Object(r["g"])("button",{type:"button",class:"btn btn-link mr-2",onClick:Object(r["J"])((function(t){return w.updateCategory(e.id,e.name)}),["stop","prevent"])}," Save ",8,O),[[r["F"],e.isEditing]]),Object(r["g"])("button",{type:"button",class:"btn btn-link mr-2",onClick:Object(r["J"])((function(t){return w.deleteCategories(e.id)}),["stop","prevent"])}," Delete ",8,h)])])})),128))])]))])}var w=n("5530"),k=n("1da1"),C=(n("96cf"),n("d81d"),n("4de4"),n("d3b7"),n("e04c")),y=n("2375"),x=n("be6c"),E=n("2fa3"),I={name:"AdminCategories",components:{AdminNav:C["a"],Spinner:y["a"]},data:function(){return{categories:[],newCategoryName:"",isLoading:!0}},created:function(){this.fetchCategories()},methods:{fetchCategories:function(){var e=this;return Object(k["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,t.next=4,x["a"].categories.get();case 4:n=t.sent,r=n.data,e.categories=r.categories.map((function(e){return Object(w["a"])(Object(w["a"])({},e),{},{isEditing:!1,nameCached:""})})),e.isLoading=!1,t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](0),e.isLoading=!1,E["a"].fire({icon:"error",title:"無法取得餐廳類別，請稍後再試"});case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))()},createCategory:function(){var e=this;return Object(k["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x["a"].categories.create({name:e.newCategoryName});case 3:if(n=t.sent,r=n.data,"success"===r.status){t.next=7;break}throw new Error(r.message);case 7:e.newCategoryName="",E["a"].fire({icon:"success",title:"成功新增餐廳類別!"}),e.fetchCategories(),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),E["a"].fire({icon:"error",title:"無法新增餐廳類別，請稍後再試"});case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()},deleteCategories:function(e){var t=this;return Object(k["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,x["a"].categories.delete(e);case 3:if(r=n.sent,a=r.data,"success"===a.status){n.next=7;break}throw new Error(a.message);case 7:t.categories=t.categories.filter((function(t){return t.id!==e})),E["a"].fire({icon:"success",title:"成功刪除餐廳類別!"}),n.next=14;break;case 11:n.prev=11,n.t0=n["catch"](0),E["a"].fire({icon:"error",title:"無法刪除餐廳類別，請稍後再試"});case 14:case"end":return n.stop()}}),n,null,[[0,11]])})))()},toggleIsEditing:function(e){this.categories=this.categories.map((function(t){return t.id===e?Object(w["a"])(Object(w["a"])({},t),{},{isEditing:!t.isEditing,nameCached:t.name}):t}))},updateCategory:function(e,t){var n=this;return Object(k["a"])(regeneratorRuntime.mark((function r(){var a,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,x["a"].categories.update({categoryId:e,name:t});case 3:if(a=r.sent,c=a.data,"success"===c.status){r.next=7;break}throw new Error(c.message);case 7:n.toggleIsEditing(e),E["a"].fire({icon:"success",title:"成功編輯餐廳類別!"}),r.next=14;break;case 11:r.prev=11,r.t0=r["catch"](0),E["a"].fire({icon:"error",title:"無法編輯餐廳類別，請稍後再試"});case 14:case"end":return r.stop()}}),r,null,[[0,11]])})))()},handleCancel:function(e){this.categories=this.categories.map((function(t){return t.id===e?Object(w["a"])(Object(w["a"])({},t),{},{name:t.nameCached}):t}))}}},R=(n("0995"),n("6b0d")),N=n.n(R);const A=N()(I,[["render",v],["__scopeId","data-v-aadf0b18"]]);t["default"]=A},be6c:function(e,t,n){"use strict";n("b0c0");var r=n("2fa3");t["a"]={categories:{get:function(){return r["b"].get("/admin/categories")},create:function(e){var t=e.name;return r["b"].post("/admin/categories",{name:t})},delete:function(e){return r["b"].delete("/admin/categories/".concat(e))},update:function(e){var t=e.categoryId,n=e.name;return r["b"].put("/admin/categories/".concat(t),{name:n})}},users:{get:function(){return r["b"].get("/admin/users")},update:function(e){var t=e.userId,n=e.isAdmin;return r["b"].put("/admin/users/".concat(t),{isAdmin:n})}},restaurants:{create:function(e){var t=e.formData;return r["b"].post("/admin/restaurants",t)},get:function(){return r["b"].get("/admin/restaurants")},delete:function(e){return r["b"].delete("/admin/restaurants/".concat(e))},getDetail:function(e){return r["b"].get("/admin/restaurants/".concat(e))},update:function(e){var t=e.restaurantId,n=e.formData;return r["b"].put("/admin/restaurants/".concat(t),n)}}}},d81d:function(e,t,n){"use strict";var r=n("23e7"),a=n("b727").map,c=n("1dde"),i=c("map");r({target:"Array",proto:!0,forced:!i},{map:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},e04c:function(e,t,n){"use strict";var r=n("7a23"),a={class:"mb-3"},c=Object(r["g"])("h1",null,"餐廳後台",-1),i=Object(r["h"])("Restaurants"),s=Object(r["h"])(" | "),o=Object(r["h"])("Categories"),u=Object(r["h"])(" | "),d=Object(r["h"])("Users");function b(e,t){var n=Object(r["z"])("router-link");return Object(r["s"])(),Object(r["f"])("div",a,[c,Object(r["i"])(n,{to:"/admin/restaurants"},{default:Object(r["H"])((function(){return[i]})),_:1}),s,Object(r["i"])(n,{to:"/admin/categories"},{default:Object(r["H"])((function(){return[o]})),_:1}),u,Object(r["i"])(n,{to:"/admin/users"},{default:Object(r["H"])((function(){return[d]})),_:1})])}var g=n("6b0d"),l=n.n(g);const f={},m=l()(f,[["render",b]]);t["a"]=m}}]);
//# sourceMappingURL=chunk-9f730d7a.e5fb5f0d.js.map