(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c50f41a"],{"12b2":function(e,t,a){"use strict";a("b0c0"),a("a4d3"),a("e01a");var r=a("7a23"),n={class:"form-group"},i=Object(r["g"])("label",{for:"name"},"Name",-1),s={class:"form-group"},c=Object(r["g"])("label",{for:"categoryId"},"Category",-1),o=Object(r["g"])("option",{value:"",selected:"",disabled:""},"--請選擇--",-1),u=["value"],d={class:"form-group"},l=Object(r["g"])("label",{for:"tel"},"Tel",-1),g={class:"form-group"},m=Object(r["g"])("label",{for:"address"},"Address",-1),b={class:"form-group"},f=Object(r["g"])("label",{for:"opening-hours"},"Opening Hours",-1),p={class:"form-group"},h=Object(r["g"])("label",{for:"description"},"Description",-1),O={class:"form-group"},j=Object(r["g"])("label",{for:"image"},"Image",-1),v=["src"],y=["disabled"];function w(e,t,a,w,I,R){var k=Object(r["z"])("Spinner");return I.isLoading?(Object(r["s"])(),Object(r["d"])(k,{key:0})):(Object(r["s"])(),Object(r["f"])("form",{key:1,onSubmit:t[7]||(t[7]=Object(r["J"])((function(){return R.handleSubmit&&R.handleSubmit.apply(R,arguments)}),["stop","prevent"]))},[Object(r["g"])("div",n,[i,Object(r["I"])(Object(r["g"])("input",{id:"name","onUpdate:modelValue":t[0]||(t[0]=function(e){return I.restaurant.name=e}),type:"text",class:"form-control",name:"name",placeholder:"Enter name",required:""},null,512),[[r["E"],I.restaurant.name]])]),Object(r["g"])("div",s,[c,Object(r["I"])(Object(r["g"])("select",{id:"categoryId","onUpdate:modelValue":t[1]||(t[1]=function(e){return I.restaurant.categoryId=e}),class:"form-control",name:"categoryId",required:""},[o,(Object(r["s"])(!0),Object(r["f"])(r["a"],null,Object(r["y"])(I.categories,(function(e){return Object(r["s"])(),Object(r["f"])("option",{key:e.id,value:e.id},Object(r["B"])(e.name),9,u)})),128))],512),[[r["D"],I.restaurant.categoryId]])]),Object(r["g"])("div",d,[l,Object(r["I"])(Object(r["g"])("input",{id:"tel","onUpdate:modelValue":t[2]||(t[2]=function(e){return I.restaurant.tel=e}),type:"text",class:"form-control",name:"tel",placeholder:"Enter telephone number"},null,512),[[r["E"],I.restaurant.tel]])]),Object(r["g"])("div",g,[m,Object(r["I"])(Object(r["g"])("input",{id:"address","onUpdate:modelValue":t[3]||(t[3]=function(e){return I.restaurant.address=e}),type:"text",class:"form-control",placeholder:"Enter address",name:"address"},null,512),[[r["E"],I.restaurant.address]])]),Object(r["g"])("div",b,[f,Object(r["I"])(Object(r["g"])("input",{id:"opening-hours","onUpdate:modelValue":t[4]||(t[4]=function(e){return I.restaurant.openingHours=e}),type:"time",class:"form-control",name:"opening_hours"},null,512),[[r["E"],I.restaurant.openingHours]])]),Object(r["g"])("div",p,[h,Object(r["I"])(Object(r["g"])("textarea",{id:"description","onUpdate:modelValue":t[5]||(t[5]=function(e){return I.restaurant.description=e}),class:"form-control",rows:"3",name:"description"},null,512),[[r["E"],I.restaurant.description]])]),Object(r["g"])("div",O,[j,I.restaurant.image?(Object(r["s"])(),Object(r["f"])("img",{key:0,src:I.restaurant.image,class:"d-block img-thumbnail mb-3",width:"200",height:"200"},null,8,v)):Object(r["e"])("",!0),Object(r["g"])("input",{id:"image",type:"file",name:"image",accept:"image/*",class:"form-control-file",onChange:t[6]||(t[6]=function(){return R.handleFileChange&&R.handleFileChange.apply(R,arguments)})},null,32)]),Object(r["g"])("button",{type:"submit",class:"btn btn-primary",disabled:a.isProcessing},Object(r["B"])(a.isProcessing?"處理中...":"送出"),9,y)],32))}var I=a("1da1"),R=a("5530"),k=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("96cf"),a("be6c")),x=a("2375"),A=a("2fa3"),E={name:"AdminRestaurantForm",components:{Spinner:x["a"]},props:{initialRestaurant:{type:Object,default:function(){return{name:"",categoryId:"",tel:"",address:"",description:"",image:"",openingHours:""}}},isProcessing:{type:Boolean,default:!1}},data:function(){return{restaurant:{name:"",categoryId:"",tel:"",address:"",description:"",image:"",openingHours:""},categories:[],isLoading:!0}},watch:{initialRestaurant:function(e){this.restaurant=Object(R["a"])(Object(R["a"])({},this.restaurant),e)}},created:function(){this.fetchCategories(),this.restaurant=Object(R["a"])(Object(R["a"])({},this.restaurant),this.initialRestaurant)},methods:{fetchCategories:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,t.next=4,k["a"].categories.get();case 4:a=t.sent,r=a.data,e.categories=r.categories,e.isLoading=!1,t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](0),e.isLoading=!1,A["a"].fire({icon:"error",title:"無法取得餐廳類別，請稍後再試"});case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))()},handleFileChange:function(e){if(this.restaurant.name)if(this.restaurant.categoryId){var t=e.target.files;if(0===t.length)this.restaurant.image="";else{var a=window.URL.createObjectURL(t[0]);this.restaurant.image=a}}else A["a"].fire({icon:"warning",title:"請選擇餐廳類別"});else A["a"].fire({icon:"warning",title:"請填寫餐廳名稱"})},handleSubmit:function(e){var t=e.target,a=new FormData(t);this.$emit("after-submit",a)}}},S=a("6b0d"),U=a.n(S);const C=U()(E,[["render",w]]);t["a"]=C},6945:function(e,t,a){"use strict";a.r(t);var r=a("7a23"),n={class:"container py-5"};function i(e,t,a,i,s,c){var o=Object(r["z"])("AdminRestaurantForm");return Object(r["s"])(),Object(r["f"])("div",n,[Object(r["i"])(o,{"initial-restaurant":s.restaurant,"is-processing":s.isProcessing,onAfterSubmit:c.handleAfterSubmit},null,8,["initial-restaurant","is-processing","onAfterSubmit"])])}var s=a("5530"),c=a("1da1"),o=(a("96cf"),a("b0c0"),a("a4d3"),a("e01a"),a("12b2")),u=a("be6c"),d=a("2fa3"),l={name:"AdminRestaurantEdit",components:{AdminRestaurantForm:o["a"]},data:function(){return{restaurant:{id:void 0,name:"",tel:"",address:"",openingHours:"",description:"",image:"",categoryId:void 0},isProcessing:!1}},beforeRouteUpdate:function(e,t,a){var r=e.params.id;this.fetchRestaurant(r),a()},created:function(){var e=this.$route.params.id;this.fetchRestaurant(e)},methods:{fetchRestaurant:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var r,n,i,c,o,l,g,m,b,f,p;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,u["a"].restaurants.getDetail(e);case 3:r=a.sent,n=r.data,i=n.restaurant,c=i.id,o=i.name,l=i.tel,g=i.address,m=i.opening_hours,b=i.description,f=i.image,p=i.CategoryId,t.restaurant=Object(s["a"])(Object(s["a"])({},t.restaurant),{},{id:c,name:o,tel:l,address:g,openingHours:m,description:b,image:f,categoryId:p}),a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](0),d["a"].fire({icon:"error",title:"無法取得餐廳資料，請稍後再試"});case 12:case"end":return a.stop()}}),a,null,[[0,9]])})))()},handleAfterSubmit:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,t.isProcessing=!0,a.next=4,u["a"].restaurants.update({restaurantId:t.restaurant.id,formData:e});case 4:if(r=a.sent,n=r.data,"success"===n.status){a.next=8;break}throw new Error(n.message);case 8:t.$router.push({name:"admin-restaurants"}),a.next=15;break;case 11:a.prev=11,a.t0=a["catch"](0),t.isProcessing=!1,d["a"].fire({icon:"error",title:"無法更新餐廳資料，請稍後再試"});case 15:case"end":return a.stop()}}),a,null,[[0,11]])})))()}}},g=a("6b0d"),m=a.n(g);const b=m()(l,[["render",i]]);t["default"]=b},be6c:function(e,t,a){"use strict";a("b0c0");var r=a("2fa3");t["a"]={categories:{get:function(){return r["b"].get("/admin/categories")},create:function(e){var t=e.name;return r["b"].post("/admin/categories",{name:t})},delete:function(e){return r["b"].delete("/admin/categories/".concat(e))},update:function(e){var t=e.categoryId,a=e.name;return r["b"].put("/admin/categories/".concat(t),{name:a})}},users:{get:function(){return r["b"].get("/admin/users")},update:function(e){var t=e.userId,a=e.isAdmin;return r["b"].put("/admin/users/".concat(t),{isAdmin:a})}},restaurants:{create:function(e){var t=e.formData;return r["b"].post("/admin/restaurants",t)},get:function(){return r["b"].get("/admin/restaurants")},delete:function(e){return r["b"].delete("/admin/restaurants/".concat(e))},getDetail:function(e){return r["b"].get("/admin/restaurants/".concat(e))},update:function(e){var t=e.restaurantId,a=e.formData;return r["b"].put("/admin/restaurants/".concat(t),a)}}}}}]);
//# sourceMappingURL=chunk-3c50f41a.651d4b45.js.map