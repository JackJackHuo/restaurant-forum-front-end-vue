(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ab43a"],{1511:function(e,t,r){"use strict";r.r(t);var n=r("7a23"),a={class:"album py-5 bg-light"},c={class:"container"},s={class:"row"},l={class:"col-md-4"},o=Object(n["g"])("br",null,null,-1),i={class:"col-md-8"},u=Object(n["g"])("br",null,null,-1);function d(e,t,r,d,b,O){var j=Object(n["z"])("UserProfileCard"),f=Object(n["z"])("UserFollowingsCard"),g=Object(n["z"])("UserFollowersCard"),m=Object(n["z"])("UserCommentsCard"),p=Object(n["z"])("UserFavoritedRestaurantsCard");return Object(n["s"])(),Object(n["f"])("div",a,[Object(n["g"])("div",c,[Object(n["i"])(j,{"initial-profile":b.profile},null,8,["initial-profile"]),Object(n["g"])("div",s,[Object(n["g"])("div",l,[Object(n["i"])(f,{followings:b.profile.Followings},null,8,["followings"]),o,Object(n["i"])(g,{followers:b.profile.Followers},null,8,["followers"])]),Object(n["g"])("div",i,[Object(n["i"])(m,{comments:b.profile.Comments},null,8,["comments"]),u,Object(n["i"])(p,{favoritedRestaurants:b.profile.FavoritedRestaurants},null,8,["favoritedRestaurants"])])])])])}var b=r("5530"),O=r("1da1"),j=(r("96cf"),r("b0c0"),r("4de4"),r("d3b7"),{class:"card mb-3"}),f={class:"row no-gutters"},g={class:"col-md-4"},m=["src"],p={class:"col-md-8"},v={class:"card-body"},w={class:"card-title"},h={class:"card-text"},y={class:"list-unstyled list-inline"},F=Object(n["h"])(" 已評論餐廳 "),k=Object(n["h"])(" 收藏的餐廳 "),C=Object(n["h"])(" followings (追蹤者) "),R=Object(n["h"])(" followers (追隨者) "),U=Object(n["g"])("p",null,null,-1),x={action:"/following/2",method:"POST",style:{display:"contents"}},z=Object(n["g"])("p",null,null,-1),A=Object(n["h"])(" 編輯 ");function B(e,t,r,a,c,s){var l=Object(n["z"])("router-link");return Object(n["s"])(),Object(n["f"])("div",j,[Object(n["g"])("div",f,[Object(n["g"])("div",g,[Object(n["g"])("img",{src:e.emptyImage(c.profile.image)},null,8,m)]),Object(n["g"])("div",p,[Object(n["g"])("div",v,[Object(n["g"])("h5",w,Object(n["B"])(c.profile.name),1),Object(n["g"])("p",h,Object(n["B"])(c.profile.email),1),Object(n["g"])("ul",y,[Object(n["g"])("li",null,[Object(n["g"])("strong",null,Object(n["B"])(c.profile.Comments.length),1),F]),Object(n["g"])("li",null,[Object(n["g"])("strong",null,Object(n["B"])(c.profile.FavoritedRestaurants.length),1),k]),Object(n["g"])("li",null,[Object(n["g"])("strong",null,Object(n["B"])(c.profile.Followings.length),1),C]),Object(n["g"])("li",null,[Object(n["g"])("strong",null,Object(n["B"])(c.profile.Followers.length),1),R])]),U,Object(n["g"])("form",x,[c.profile.isFollowed?(Object(n["s"])(),Object(n["f"])("button",{key:0,type:"submit",class:"btn btn-danger",onClick:t[0]||(t[0]=Object(n["J"])((function(e){return s.deleteFollowing(c.profile.id)}),["stop","prevent"]))}," 取消追蹤 ")):(Object(n["s"])(),Object(n["f"])("button",{key:1,type:"submit",class:"btn btn-primary",onClick:t[1]||(t[1]=Object(n["J"])((function(e){return s.addFollowing(c.profile.id)}),["stop","prevent"]))},"追蹤"))]),z,c.profile.id===e.currentUser.id?(Object(n["s"])(),Object(n["d"])(l,{key:0,to:{name:"user-edit",params:{id:e.currentUser.id}},class:"btn btn-secondary"},{default:Object(n["H"])((function(){return[A]})),_:1},8,["to"])):Object(n["e"])("",!0)])])])])}var P=r("2708"),I=r("5502"),q=r("1602"),H=r("2fa3"),_={name:"UserProfileCard",mixins:[P["a"]],props:{initialProfile:{type:Object,required:!0}},watch:{initialProfile:function(e){this.profile=Object(b["a"])(Object(b["a"])({},this.profile),e)}},data:function(){return{profile:this.initialProfile}},computed:Object(b["a"])({},Object(I["b"])(["currentUser"])),methods:{addFollowing:function(e){var t=this;return Object(O["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,q["a"].addFollowing(e);case 3:if(n=r.sent,a=n.data,"success"===a.status){r.next=7;break}throw new Error(a.message);case 7:t.profile=Object(b["a"])(Object(b["a"])({},t.profile),{},{isFollowed:!0}),H["a"].fire({icon:"success",title:"成功追蹤!"}),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.log("error",r.t0),H["a"].fire({icon:"error",title:"無法追蹤，請稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()},deleteFollowing:function(e){var t=this;return Object(O["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,q["a"].deleteFollowing(e);case 3:if(n=r.sent,a=n.data,"success"===a.status){r.next=7;break}throw new Error(a.message);case 7:t.profile=Object(b["a"])(Object(b["a"])({},t.profile),{},{isFollowed:!1}),H["a"].fire({icon:"success",title:"成功取消追蹤!"}),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.log("error",r.t0),H["a"].fire({icon:"error",title:"無法追蹤，請稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()}}},J=r("6b0d"),E=r.n(J);const S=E()(_,[["render",B]]);var T=S,$={class:"card"},D={class:"card-header"},G=Object(n["h"])(" followings (追蹤者)"),K={class:"card-body"},L=["src"];function M(e,t,r,a,c,s){var l=Object(n["z"])("router-link");return Object(n["s"])(),Object(n["f"])("div",$,[Object(n["g"])("div",D,[Object(n["g"])("strong",null,Object(n["B"])(r.followings.length),1),G]),Object(n["g"])("div",K,[(Object(n["s"])(!0),Object(n["f"])(n["a"],null,Object(n["y"])(r.followings,(function(t){return Object(n["s"])(),Object(n["d"])(l,{key:t.id,to:{name:"user",params:{id:t.id}}},{default:Object(n["H"])((function(){return[Object(n["g"])("img",{src:e.emptyImage(t.image),width:"60",height:"60",class:"avatar"},null,8,L)]})),_:2},1032,["to"])})),128))])])}var N={name:"UserFollowingsCard",mixins:[P["a"]],props:{followings:{type:Array,default:function(){return[]}}}};const Q=E()(N,[["render",M]]);var V=Q,W={class:"card"},X={class:"card-header"},Y=Object(n["h"])(" followers (追隨者)"),Z={class:"card-body"},ee=["src"];function te(e,t,r,a,c,s){var l=Object(n["z"])("router-link");return Object(n["s"])(),Object(n["f"])("div",W,[Object(n["g"])("div",X,[Object(n["g"])("strong",null,Object(n["B"])(r.followers.length),1),Y]),Object(n["g"])("div",Z,[(Object(n["s"])(!0),Object(n["f"])(n["a"],null,Object(n["y"])(r.followers,(function(e){return Object(n["s"])(),Object(n["d"])(l,{key:e.id,to:{name:"user",query:{id:e.id}}},{default:Object(n["H"])((function(){return[Object(n["g"])("img",{src:e.image,width:"60",height:"60",class:"avatar"},null,8,ee)]})),_:2},1032,["to"])})),128))])])}var re={name:"UserFollowersCard",props:{followers:{type:Array,default:function(){return[]}}}};const ne=E()(re,[["render",te]]);var ae=ne,ce={class:"card"},se={class:"card-header"},le=Object(n["h"])(" 已評論餐廳"),oe={class:"card-body"},ie=["src"];function ue(e,t,r,a,c,s){var l=Object(n["z"])("router-link");return Object(n["s"])(),Object(n["f"])("div",ce,[Object(n["g"])("div",se,[Object(n["g"])("strong",null,Object(n["B"])(r.comments.length),1),le]),Object(n["g"])("div",oe,[(Object(n["s"])(!0),Object(n["f"])(n["a"],null,Object(n["y"])(r.comments,(function(t){return Object(n["s"])(),Object(n["d"])(l,{key:t.id,to:{name:"restaurant",query:{restaurantId:t.Restaurant.id}}},{default:Object(n["H"])((function(){return[Object(n["g"])("img",{src:e.emptyImage(t.Restaurant.image),width:"60",height:"60",class:"avatar"},null,8,ie)]})),_:2},1032,["to"])})),128))])])}var de={name:"UserCommentsCard",mixins:[P["a"]],props:{comments:{type:Array,default:function(){return[]}}}};const be=E()(de,[["render",ue]]);var Oe=be,je={class:"card"},fe={class:"card-header"},ge=Object(n["h"])(" 收藏的餐廳"),me={class:"card-body"},pe=["src"];function ve(e,t,r,a,c,s){var l=Object(n["z"])("router-link");return Object(n["s"])(),Object(n["f"])("div",je,[Object(n["g"])("div",fe,[Object(n["g"])("strong",null,Object(n["B"])(r.favoritedRestaurants.length),1),ge]),Object(n["g"])("div",me,[(Object(n["s"])(!0),Object(n["f"])(n["a"],null,Object(n["y"])(r.favoritedRestaurants,(function(e){return Object(n["s"])(),Object(n["d"])(l,{key:e.id,to:{name:"restaurant",query:{restaurantId:e.id}}},{default:Object(n["H"])((function(){return[Object(n["g"])("img",{src:e.image,width:"60",height:"60",class:"avatar"},null,8,pe)]})),_:2},1032,["to"])})),128))])])}var we={name:"UserFavoritedRestaurantsCard",props:{favoritedRestaurants:{type:Array,required:!0}}};const he=E()(we,[["render",ve]]);var ye=he,Fe={name:"User",components:{UserProfileCard:T,UserFollowingsCard:V,UserFollowersCard:ae,UserCommentsCard:Oe,UserFavoritedRestaurantsCard:ye},data:function(){return{profile:{id:void 0,name:"",email:"",isAdmin:!1,image:"",createdAt:"",Comments:[],FavoritedRestaurants:[],Followers:[],Followings:[],isFollowed:!1}}},created:function(){var e=this.$route.params.id;this.fetchUserProfile(e)},beforeRouteUpdate:function(e,t,r){var n=e.params.id;this.fetchUserProfile(n),r()},methods:{fetchUserProfile:function(e){var t=this;return Object(O["a"])(regeneratorRuntime.mark((function r(){var n,a,c,s,l,o,i,u,d,O,j,f,g;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,q["a"].get({userId:e});case 3:if(n=r.sent,a=n.data,a){r.next=7;break}throw new Error("無法取得使用者資料");case 7:c=a.profile,s=c.id,l=c.name,o=c.email,i=c.isAdmin,u=c.image,d=c.createdAt,O=c.Comments,j=c.FavoritedRestaurants,f=c.Followers,g=c.Followings,t.profile=Object(b["a"])(Object(b["a"])({},t.profile),{},{id:s,name:l,email:o,isAdmin:i,image:u,createdAt:d,Comments:O.filter((function(e){return e.Restaurant})),FavoritedRestaurants:j,Followers:f,Followings:g,isFollowed:a.isFollowed}),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.log("error",r.t0),H["a"].fire({icon:"error",title:"無法取得使用者資料，請稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()}}};const ke=E()(Fe,[["render",d]]);t["default"]=ke}}]);
//# sourceMappingURL=chunk-2d0ab43a.8fd7b277.js.map