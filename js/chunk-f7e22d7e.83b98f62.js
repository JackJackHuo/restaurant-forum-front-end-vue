(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f7e22d7e"],{1535:function(e,t,r){"use strict";r("a059")},"3af9":function(e,t,r){"use strict";r("55da")},"55da":function(e,t,r){},"90c6":function(e,t,r){"use strict";r("f9cb")},a059:function(e,t,r){},ad68:function(e,t,r){"use strict";r.r(t);var n=r("7a23"),a={class:"container py-5"},c=Object(n["g"])("hr",null,null,-1);function s(e,t,r,s,i,o){var u=Object(n["z"])("Spinner"),b=Object(n["z"])("RestaurantDetail"),l=Object(n["z"])("RestaurantComments"),d=Object(n["z"])("CreateComment");return Object(n["s"])(),Object(n["f"])("div",a,[i.isLoading?(Object(n["s"])(),Object(n["d"])(u,{key:0})):(Object(n["s"])(),Object(n["f"])(n["a"],{key:1},[Object(n["i"])(b,{"initial-restaurant":i.restaurant},null,8,["initial-restaurant"]),c,Object(n["i"])(l,{"restaurant-comments":i.restaurantComments,onAfterDeleteComment:o.afterDeleteComment},null,8,["restaurant-comments","onAfterDeleteComment"]),Object(n["i"])(d,{"restaurant-id":i.restaurant.id,onAfterCreateComment:o.afterCreateComment},null,8,["restaurant-id","onAfterCreateComment"])],64))])}var i=r("1da1"),o=r("5530"),u=(r("96cf"),r("b0c0"),r("a4d3"),r("e01a"),r("4de4"),r("d3b7"),function(e){return Object(n["v"])("data-v-983e296e"),e=e(),Object(n["t"])(),e}),b={class:"row"},l={class:"col-md-12 mb-3"},d={class:"badge badge-secondary mt-1 mb-3"},m={class:"col-lg-4"},f=["src"],j={class:"contact-info-wrap"},O={class:"list-unstyled"},p=u((function(){return Object(n["g"])("strong",null,"Opening Hour:",-1)})),g=u((function(){return Object(n["g"])("strong",null,"Tel:",-1)})),v=u((function(){return Object(n["g"])("strong",null,"Address:",-1)})),h={class:"col-lg-8"},k=Object(n["h"])("Dashboard ");function w(e,t,r,a,c,s){var i=Object(n["z"])("router-link");return Object(n["s"])(),Object(n["f"])("div",b,[Object(n["g"])("div",l,[Object(n["g"])("h1",null,Object(n["B"])(c.restaurant.name),1),Object(n["g"])("p",d,Object(n["B"])(c.restaurant.categoryName),1)]),Object(n["g"])("div",m,[Object(n["g"])("img",{class:"img-responsive center-block",src:c.restaurant.image,style:{width:"250px","margin-bottom":"25px"}},null,8,f),Object(n["g"])("div",j,[Object(n["g"])("ul",O,[Object(n["g"])("li",null,[p,Object(n["h"])(" "+Object(n["B"])(c.restaurant.openingHours),1)]),Object(n["g"])("li",null,[g,Object(n["h"])(" "+Object(n["B"])(c.restaurant.tel),1)]),Object(n["g"])("li",null,[v,Object(n["h"])(" "+Object(n["B"])(c.restaurant.address),1)])])])]),Object(n["g"])("div",h,[Object(n["g"])("p",null,Object(n["B"])(c.restaurant.description),1),Object(n["i"])(i,{class:"btn btn-primary btn-border mr-2",to:{name:"restaurant-dashboard",params:{id:c.restaurant.id}}},{default:Object(n["H"])((function(){return[k]})),_:1},8,["to"]),c.restaurant.isFavorited?(Object(n["s"])(),Object(n["f"])("button",{key:0,type:"button",class:"btn btn-danger btn-border mr-2",onClick:t[0]||(t[0]=Object(n["J"])((function(e){return s.deleteFavorite(c.restaurant.id)}),["stop","prevent"]))}," 移除最愛 ")):(Object(n["s"])(),Object(n["f"])("button",{key:1,type:"button",class:"btn btn-primary btn-border mr-2",onClick:t[1]||(t[1]=Object(n["J"])((function(e){return s.addFavorite(c.restaurant.id)}),["stop","prevent"]))}," 加到最愛 ")),c.restaurant.isLiked?(Object(n["s"])(),Object(n["f"])("button",{key:2,type:"button",class:"btn btn-danger like mr-2",onClick:t[2]||(t[2]=Object(n["J"])((function(e){return s.deleteLike(c.restaurant.id)}),["stop","prevent"]))}," Unlike ")):(Object(n["s"])(),Object(n["f"])("button",{key:3,type:"button",class:"btn btn-primary like mr-2",onClick:t[3]||(t[3]=Object(n["J"])((function(e){return s.addLike(c.restaurant.id)}),["stop","prevent"]))}," Like "))])])}r("38cf"),r("f6d6");var x=r("1602"),C=r("2fa3"),y={name:"RestaurantDetail",props:{initialRestaurant:{type:Object,required:!0}},watch:{initialRestaurant:function(e){this.restaurant=Object(o["a"])(Object(o["a"])({},this.restaurant),e)}},data:function(){return{restaurant:this.initialRestaurant}},methods:{addFavorite:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,x["a"].addFavorite(e);case 3:if(n=r.sent,a=n.data,"success"===a.status){r.next=7;break}throw new Error(a.message);case 7:t.restaurant=Object(o["a"])(Object(o["a"])({},t.restaurant),{},{isFavorited:!0}),C["a"].fire({icon:"success",title:"成功將餐廳新增最愛!"}),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.log("error",r.t0),C["a"].fire({icon:"error",title:"無法將餐廳新增最愛，請稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()},deleteFavorite:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,x["a"].deleteFavorite(e);case 3:if(n=r.sent,a=n.data,"success"===a.status){r.next=7;break}throw new Error(a.message);case 7:t.restaurant=Object(o["a"])(Object(o["a"])({},t.restaurant),{},{isFavorited:!1}),C["a"].fire({icon:"success",title:"成功將餐廳移除最愛!"}),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.log("error",r.t0),C["a"].fire({icon:"error",title:"無法將餐廳移除最愛，請稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()},addLike:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,x["a"].addLike(e);case 3:if(n=r.sent,a=n.data,"success"===a.status){r.next=7;break}throw new Error(a.message);case 7:t.restaurant=Object(o["a"])(Object(o["a"])({},t.restaurant),{},{isLiked:!0}),C["a"].fire({icon:"success",title:String.fromCodePoint(128158).repeat(10)}),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.log("error",r.t0),C["a"].fire({icon:"error",title:"無法將餐廳按讚，請稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()},deleteLike:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,x["a"].deleteLike(e);case 3:if(n=r.sent,a=n.data,"success"===a.status){r.next=7;break}throw new Error(a.message);case 7:t.restaurant=Object(o["a"])(Object(o["a"])({},t.restaurant),{},{isLiked:!1}),C["a"].fire({icon:"success",title:String.fromCodePoint(128148).repeat(10)}),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),C["a"].fire({icon:"error",title:"無法將餐廳取消按讚，請稍後再試"}),console.log("error",r.t0);case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()}}},R=(r("90c6"),r("6b0d")),L=r.n(R);const I=L()(y,[["render",w],["__scopeId","data-v-983e296e"]]);var D=I,F=function(e){return Object(n["v"])("data-v-40bc728f"),e=e(),Object(n["t"])(),e},B=F((function(){return Object(n["g"])("h2",{class:"my-4"}," 所有評論： ",-1)})),U={class:"blockquote mb-0"},A=["onClick"],J={href:"#"},S={class:"blockquote-footer"},_=F((function(){return Object(n["g"])("hr",null,null,-1)}));function E(e,t,r,a,c,s){return Object(n["s"])(),Object(n["f"])("div",null,[B,(Object(n["s"])(!0),Object(n["f"])(n["a"],null,Object(n["y"])(r.restaurantComments,(function(t){return Object(n["s"])(),Object(n["f"])("div",{key:t.id},[Object(n["g"])("blockquote",U,[e.currentUser.isAdmin?(Object(n["s"])(),Object(n["f"])("button",{key:0,type:"button",class:"btn btn-danger float-right",onClick:Object(n["J"])((function(e){return s.handleDeleteButtonClicked(t.id)}),["stop","prevent"])}," Delete ",8,A)):Object(n["e"])("",!0),Object(n["g"])("h3",null,[Object(n["g"])("a",J,Object(n["B"])(t.User.name),1)]),Object(n["g"])("p",null,Object(n["B"])(t.text),1),Object(n["g"])("footer",S,Object(n["B"])(e.fromNow(t.createdAt)),1)]),_])})),128))])}var q=r("2708"),z=r("5502"),H=r("c4c3"),N={name:"RestaurantComments",mixins:[q["b"]],props:{restaurantComments:{type:Array,required:!0}},computed:Object(o["a"])({},Object(z["b"])(["currentUser"])),methods:{handleDeleteButtonClicked:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,H["a"].comments.delete({commentId:e});case 3:if(n=r.sent,a=n.data,"success"===a.status){r.next=7;break}throw new Error(a.message);case 7:t.$emit("after-delete-comment",e),r.next=14;break;case 10:r.prev=10,r.t0=r["catch"](0),console.log("error",r.t0),C["a"].fire({icon:"error",title:"無法刪除評論，請稍後再試"});case 14:case"end":return r.stop()}}),r,null,[[0,10]])})))()}}};r("1535");const $=L()(N,[["render",E],["__scopeId","data-v-40bc728f"]]);var P=$,T=function(e){return Object(n["v"])("data-v-1b7909e0"),e=e(),Object(n["t"])(),e},V={class:"form-group mb-4"},G=T((function(){return Object(n["g"])("label",{for:"text"},"留下評論：",-1)})),K={class:"d-flex align-items-center justify-content-between"},M=T((function(){return Object(n["g"])("button",{type:"submit",class:"btn btn-primary mr-0"}," Submit ",-1)}));function Q(e,t,r,a,c,s){return Object(n["s"])(),Object(n["f"])("form",{onSubmit:t[2]||(t[2]=Object(n["J"])((function(e){return s.handleSubmit(r.restaurantId)}),["stop","prevent"]))},[Object(n["g"])("div",V,[G,Object(n["I"])(Object(n["g"])("textarea",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return c.text=e}),class:"form-control",rows:"3",name:"text"},null,512),[[n["E"],c.text]])]),Object(n["g"])("div",K,[Object(n["g"])("button",{type:"button",class:"btn btn-link",onClick:t[1]||(t[1]=function(t){return e.$router.back()})},"回上一頁"),M])],32)}r("a9e3");var W={name:"CreateComment",props:{restaurantId:{type:Number,required:!0}},data:function(){return{text:""}},methods:{handleSubmit:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,H["a"].comments.create({restaurantId:e,text:t.text});case 3:if(n=r.sent,a=n.data,"success"===a.status){r.next=7;break}throw new Error(a.message);case 7:t.$emit("after-create-comment",{commentId:a.commentId,text:t.text,restaurantId:e}),t.text="",r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.log("error",r.t0),C["a"].fire({icon:"error",title:"無法新增評論，請稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()}}};r("3af9");const X=L()(W,[["render",Q],["__scopeId","data-v-1b7909e0"]]);var Y=X,Z=r("2375"),ee={components:{RestaurantDetail:D,RestaurantComments:P,CreateComment:Y,Spinner:Z["a"]},data:function(){return{restaurant:{id:-1,name:"",categoryName:"",image:"",openingHours:"",tel:"",address:"",description:"",isFavorited:!1,isLiked:!1},restaurantComments:[],isLoading:!0}},beforeRouteUpdate:function(e,t,r){var n=e.params.id;this.fetchRestaurant(n),r()},computed:Object(o["a"])({},Object(z["b"])(["currentUser"])),created:function(){var e=this.$route.params.id;this.fetchRestaurant(e)},methods:{fetchRestaurant:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,a,c,s,i,o,u,b,l,d,m,f,j,O;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.isLoading=!0,r.prev=1,r.next=4,H["a"].getRestaurant({restaurantId:e});case 4:n=r.sent,a=n.data,c=a.restaurant,s=a.isFavorited,i=a.isLiked,o=c.id,u=c.name,b=c.tel,l=c.address,d=c.opening_hours,m=c.description,f=c.image,j=c.Category,O=c.Comments,t.restaurant={id:o,name:u,categoryName:j?j.name:"未分類",image:f,openingHours:d,tel:b,address:l,description:m,isFavorited:s,isLiked:i},t.restaurantComments=O,t.isLoading=!1,r.next=18;break;case 13:r.prev=13,r.t0=r["catch"](1),t.isLoading=!1,console.log(r.t0),C["a"].fire({icon:"error",title:"無法取得餐廳資料，請稍後再試"});case 18:case"end":return r.stop()}}),r,null,[[1,13]])})))()},afterDeleteComment:function(e){this.restaurantComments=this.restaurantComments.filter((function(t){return t.id!==e}))},afterCreateComment:function(e){var t=e.commentId,r=e.text,n=e.restaurantId;this.restaurantComments.push({id:t,RestaurantId:n,User:{id:this.currentUser.id,name:this.currentUser.name},text:r,createdAt:new Date})}}};const te=L()(ee,[["render",s]]);t["default"]=te},f9cb:function(e,t,r){}}]);
//# sourceMappingURL=chunk-f7e22d7e.83b98f62.js.map