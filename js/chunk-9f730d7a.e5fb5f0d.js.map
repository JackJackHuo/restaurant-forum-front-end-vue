{"version":3,"sources":["webpack:///./src/views/AdminCategories.vue?fb87","webpack:///./src/views/AdminCategories.vue","webpack:///./src/views/AdminCategories.vue?03c7","webpack:///./src/apis/admin.js","webpack:///./node_modules/core-js/modules/es.array.map.js","webpack:///./src/components/AdminNav.vue","webpack:///./src/components/AdminNav.vue?a4c6"],"names":["class","scope","width","newCategoryName","type","placeholder","createCategory","isLoading","categories","category","key","id","name","isEditing","handleCancel","toggleIsEditing","updateCategory","deleteCategories","components","AdminNav","Spinner","data","created","this","fetchCategories","methods","admin","get","map","nameCached","fire","icon","title","create","status","Error","message","categoryId","delete","filter","update","__exports__","render","apiHelper","post","put","users","userId","isAdmin","restaurants","formData","restaurantId","getDetail","$","$map","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT","target","proto","forced","callbackfn","arguments","length","undefined","to","script"],"mappings":"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","file":"js/chunk-9f730d7a.e5fb5f0d.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./AdminCategories.vue?vue&type=style&index=0&id=aadf0b18&scoped=true&lang=css\"","<template>\r\n  <div class=\"container py-5\">\r\n    <!-- 1. 使用先前寫好的 AdminNav -->\r\n    <AdminNav />\r\n    <form class=\"my-4\">\r\n      <div class=\"form-row\">\r\n        <div class=\"col-auto\">\r\n          <input\r\n            v-model=\"newCategoryName\"\r\n            type=\"text\"\r\n            class=\"form-control\"\r\n            placeholder=\"新增餐廳類別...\"\r\n          />\r\n        </div>\r\n        <div class=\"col-auto\">\r\n          <button\r\n            type=\"button\"\r\n            class=\"btn btn-primary\"\r\n            @click.stop.prevent=\"createCategory()\"\r\n          >\r\n            新增\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </form>\r\n    <Spinner v-if=\"isLoading\" />\r\n    <table \r\n      v-else\r\n      class=\"table\"\r\n    >\r\n      <thead class=\"thead-dark\">\r\n        <tr>\r\n          <th scope=\"col\" width=\"60\">#</th>\r\n          <th scope=\"col\">Category Name</th>\r\n          <th scope=\"col\" width=\"210\">Action</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"category in categories\" :key=\"category.id\">\r\n          <th scope=\"row\">\r\n            {{ category.id }}\r\n          </th>\r\n          <td class=\"position-relative\">\r\n            <div \r\n              v-show=\"!category.isEditing\" \r\n              class=\"category-name\"\r\n            >\r\n              {{ category.name }}\r\n            </div>\r\n            <input\r\n              v-show=\"category.isEditing\"\r\n              v-model=\"category.name\"\r\n              class=\"form-control\"\r\n              type=\"text\"\r\n            />\r\n            <span \r\n              v-show=\"category.isEditing\" \r\n              class=\"cancel\"\r\n              @click.stop.prevent=\"handleCancel(category.id)\"\r\n            > ✕ </span>\r\n          </td>\r\n          <td class=\"d-flex justify-content-between\">\r\n            <button\r\n              v-show=\"!category.isEditing\"\r\n              type=\"button\"\r\n              class=\"btn btn-link mr-2\"\r\n              @click.stop.prevent=\"toggleIsEditing(category.id)\"\r\n            >\r\n              Edit\r\n            </button>\r\n            <button\r\n              v-show=\"category.isEditing\"\r\n              type=\"button\"\r\n              class=\"btn btn-link mr-2\"\r\n              @click.stop.prevent=\"updateCategory( category.id , category.name )\"\r\n            >\r\n              Save\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn btn-link mr-2\"\r\n              @click.stop.prevent=\"deleteCategories(category.id)\"\r\n            >\r\n              Delete\r\n            </button>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport AdminNav from \"./../components/AdminNav.vue\";\r\nimport Spinner from './../components/Spinner.vue'\r\nimport adminAPI from './../apis/admin'\r\nimport { Toast } from './../utils/helpers'\r\nimport admin from './../apis/admin';\r\n// import { v4 as uuidv4 } from \"uuid\";\r\n\r\nexport default {\r\n  name: \"AdminCategories\",\r\n  components: {\r\n    AdminNav,\r\n    Spinner\r\n  },\r\n  data() {\r\n    return {\r\n      categories: [],\r\n      newCategoryName: \"\",\r\n      isLoading:true\r\n    };\r\n  },\r\n  created() {\r\n    this.fetchCategories();\r\n  },\r\n  methods: {\r\n    async fetchCategories() {\r\n      try{\r\n        this.isLoading = true\r\n        const { data } = await adminAPI.categories.get()\r\n        // AJAX餐廳類別資料時，加入isEditing跟nameCached屬性\r\n        this.categories = data.categories.map((category) => ({\r\n          ...category,\r\n          isEditing: false,\r\n          nameCached:''\r\n        }));\r\n        this.isLoading = false\r\n      }catch(error){\r\n        this.isLoading = false\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法取得餐廳類別，請稍後再試'\r\n        })\r\n      }\r\n    },\r\n    async createCategory() {\r\n      try{\r\n        // TODO: 透過 API 告知伺服器欲新增的餐廳類別...\r\n        const { data } = await adminAPI.categories.create({ name:this.newCategoryName })\r\n        if(data.status !== 'success') throw new Error(data.message)\r\n        this.newCategoryName = \"\";\r\n        Toast.fire({\r\n          icon: 'success',\r\n          title: '成功新增餐廳類別!'\r\n        })\r\n        this.fetchCategories()\r\n      }catch(error){\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法新增餐廳類別，請稍後再試'\r\n        })\r\n      }\r\n    },\r\n    async deleteCategories(categoryId) {\r\n      try{\r\n        const { data } = await admin.categories.delete(categoryId)\r\n        if(data.status !== 'success') throw new Error(data.message)\r\n        this.categories = this.categories.filter(\r\n          (category) => category.id !== categoryId\r\n        );\r\n        Toast.fire({\r\n          icon: 'success',\r\n          title: '成功刪除餐廳類別!'\r\n        })\r\n      }catch(error){\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法刪除餐廳類別，請稍後再試'\r\n        })\r\n      }\r\n    },\r\n    // 切換Editing模式時，先將原本的category name存在nameCached裡，如果取消編輯時可以復原回來。\r\n    toggleIsEditing (categoryId) {\r\n      this.categories = this.categories.map ( category => {\r\n        if(category.id === categoryId){\r\n          return {\r\n            ...category,\r\n            isEditing:!category.isEditing,\r\n            nameCached: category.name\r\n          }\r\n        }else{\r\n          return category\r\n        }\r\n      })\r\n    },\r\n    async updateCategory( categoryId , name ){\r\n      try{\r\n        // TODO: 透過 API 去向伺服器更新餐廳類別名稱\r\n        const { data } = await adminAPI.categories.update({ categoryId , name })\r\n        if(data.status !== 'success') throw new Error(data.message)\r\n        // 切換isEditing\r\n        this.toggleIsEditing(categoryId)\r\n        Toast.fire({\r\n          icon: 'success',\r\n          title: '成功編輯餐廳類別!'\r\n        })\r\n      }catch(error){\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法編輯餐廳類別，請稍後再試'\r\n        })\r\n      }\r\n    },\r\n    handleCancel (categoryId) {\r\n      this.categories = this.categories.map( category => {\r\n        if(category.id === categoryId) {\r\n          return {\r\n            ...category,\r\n            name: category.nameCached\r\n          }\r\n        }else{\r\n          return category\r\n        }\r\n      })\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.category-name {\r\n  padding: 0.375rem 0.75rem;\r\n  border: 1px solid transparent;\r\n  outline: 0;\r\n  cursor: auto;\r\n}\r\n\r\n.btn-link {\r\n  width: 62px;\r\n}\r\n\r\n.cancel {\r\n  position: absolute;\r\n  right: 20px;\r\n  top: 50%;\r\n  transform: translateY(-50%);\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 25px;\r\n  height: 25px;\r\n  border: 1px solid #aaaaaa;\r\n  border-radius: 50%;\r\n  user-select: none;\r\n  cursor: pointer;\r\n  font-size: 12px;\r\n}\r\n</style>","import { render } from \"./AdminCategories.vue?vue&type=template&id=aadf0b18&scoped=true\"\nimport script from \"./AdminCategories.vue?vue&type=script&lang=js\"\nexport * from \"./AdminCategories.vue?vue&type=script&lang=js\"\n\nimport \"./AdminCategories.vue?vue&type=style&index=0&id=aadf0b18&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\user\\\\JackHuo\\\\WebDevelopment\\\\Project\\\\Vue\\\\forum-front-end-vue\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-aadf0b18\"]])\n\nexport default __exports__","import { apiHelper } from \"../utils/helpers\";\r\n\r\nexport default {\r\n  categories: {\r\n    get() {\r\n      return apiHelper.get('/admin/categories')\r\n    },\r\n    create({name}) {\r\n      return apiHelper.post('/admin/categories' , { name })\r\n    },\r\n    delete(categoryId) {\r\n      return apiHelper.delete(`/admin/categories/${categoryId}`)\r\n    },\r\n    update({ categoryId , name }){\r\n      return apiHelper.put(`/admin/categories/${categoryId}` , { name })\r\n    }\r\n  },\r\n  users:{\r\n    get(){\r\n      return apiHelper.get('/admin/users')\r\n    },\r\n    update({ userId, isAdmin }) {\r\n      return apiHelper.put(`/admin/users/${userId}`,{ isAdmin })\r\n    }\r\n  },\r\n  restaurants: {\r\n    create({ formData }) {\r\n      return apiHelper.post('/admin/restaurants' , formData)\r\n    },\r\n    get(){\r\n      return apiHelper.get('/admin/restaurants')\r\n    },\r\n    delete(restaurantId){\r\n      return apiHelper.delete(`/admin/restaurants/${restaurantId}`)\r\n    },\r\n    getDetail(restaurantId) {\r\n      return apiHelper.get(`/admin/restaurants/${restaurantId}`)\r\n    },\r\n    update({ restaurantId, formData }) {\r\n      return apiHelper.put(`/admin/restaurants/${restaurantId}` , formData)\r\n    }\r\n  }\r\n}","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","<template>\r\n  <div class=\"mb-3\">\r\n    <h1>餐廳後台</h1>\r\n    <router-link to=\"/admin/restaurants\">Restaurants</router-link> |\r\n    <router-link to=\"/admin/categories\">Categories</router-link> |\r\n    <router-link to=\"/admin/users\">Users</router-link>\r\n  </div>\r\n</template>","import { render } from \"./AdminNav.vue?vue&type=template&id=45e394ec\"\nconst script = {}\n\nimport exportComponent from \"C:\\\\Users\\\\user\\\\JackHuo\\\\WebDevelopment\\\\Project\\\\Vue\\\\forum-front-end-vue\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}